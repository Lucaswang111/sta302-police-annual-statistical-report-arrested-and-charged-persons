#| echo: false
#| warning: false
data <- read.csv("inputs/data/Arrested_Charged_Person.csv")
data <- read.csv("inputs/data/Arrested_Charged_Person.csv")
library(readr)
Arrested_Charged_Person <- read_csv("inputs/data/Arrested_Charged_Person.csv")
View(Arrested_Charged_Person)
#| echo: false
#| warning: false
library(readr)
data <- read_csv("inputs/data/Arrested_Charged_Person.csv")
setwd("E:/9code/R script/tiydemodel/7/tellIngstory/W")
#| echo: false
#| warning: false
library(readr)
data <- read_csv("inputs/data/Arrested_Charged_Person.csv")
library(tidymodels)
library(bruceR)
data <- read.csv("inputs/data/Arrested_Charged_Person.csv")
Freq(data)
View(data)
Freq(data$SEX)
library(knitr)
Describe(data)
Freq(data$AGE_GROUP)
Freq(data$AGE_COHORT)
head(data)
head(data)
eda1 <- data %>%
group_by(ARREST_YEAR) %>%
summarize(crime = n())
View(eda1)
eda1 %>%
ggplot(aes(x = ARREST_YEAR)) +
geom_line()
eda1 %>%
ggplot(aes(x = ARREST_YEAR, y= crime)) +
geom_line() +
geom_text(aes(y = arrested_count, label = arrested_count), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Released vs. ALL Over Years", x = "Year", y = "Count") +
scale_color_manual(values = c("Released" = "blue", "ALL" = "red")) +
guides(color = guide_legend(title = "Count Type"))
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line() +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
eda1 <- data |>
group_by(ARREST_YEAR) |>
summarize(crime = n())
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line() +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
eda2 <- data |>
group_by(CATEGORY) |>
summarize(crime = n())
ggplot(eda1, aes(x = CATEGORY, y = crime)) +
geom_bar() +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
View(eda2)
ggplot(eda2, aes(x = CATEGORY, y = crime)) +
geom_bar(stat = "identity") +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime)) +
geom_bar(stat = "identity") +
geom_text(aes(label = crime), vjust = 0.5, hjust = 0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime)) +
geom_bar(stat = "identity") +
geom_text(aes(label = crime), vjust = 1, hjust = 0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime)) +
geom_bar(stat = "identity") +
geom_text(aes(label = crime), vjust = -1, hjust = 0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime)) +
geom_bar(stat = "identity") +
geom_text(aes(label = crime), vjust = -0.5, hjust = 0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue") +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",size=3) +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",linewidth = 3) +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",linewidth = 3) +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 4) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",linewidth = 3) +
geom_text(aes(label = crime), vjust = 0.5, hjust = 0, size = 4) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",linewidth = 2) +
geom_text(aes(label = crime), vjust = 0.5, hjust = 0, size = 4) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",linewidth = 2) +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.2, size = 4) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3, color = "black") +
scale_fill_manual(values = custom_palette) +
theme_minimal() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3, color = "black") +
scale_fill_manual(values = custom_palette) +
scale_fill_brewer(palette = "Set1") +
theme_minimal() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_minimal() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = 0.5, hjust = 0, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_minimal() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = 0.5, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = 1, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = 1, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = -0.5, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = -0.5, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
Freq(data$CATEGORY)
eda3 <- data |>
groupby(SEX,AGE_GROUP) |>
summaries(crime=n())
eda3 <- data |>
groupby(SEX,AGE_GROUP) |>
summarize(crime=n())
eda3 <- data |>
group_by(SEX,AGE_GROUP) |>
summarize(crime=n())
View(eda3)
eda3 <- data %>%
group_by(SEX, AGE_GROUP) %>%
summarize(crime = n(), .groups = "drop")
ggplot(eda3,aes(x=AGE_GROUP,y=crime)) +
geom_bar(stat = "identity", color = crime) +
geom_text(aes(label = crime), vjust = -0.5, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by SEX and AGE_GROUP",
x = "AGE_GROUP", y = "Count")
ggplot(eda3,aes(x=AGE_GROUP,y=crime)) +
geom_bar(stat = "identity", color = SEX) +
geom_text(aes(label = crime), vjust = -0.5, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by SEX and AGE_GROUP",
x = "AGE_GROUP", y = "Count")
eda3 <- data %>%
group_by(SEX, AGE_GROUP) %>%
summarize(crime = n(), .groups = "drop")
ggplot(eda3, aes(x = AGE_GROUP, y = crime, fill = SEX)) +
geom_bar(stat = "identity") +
geom_text(aes(label = crime), vjust = -0.5, hjust = 0.5, size = 3, color = "black") +
scale_color_brewer(palette = "Set1") +  # 修改为 scale_color_brewer
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by SEX and AGE_GROUP",
x = "AGE_GROUP", y = "Count")
ggplot(eda3, aes(x = AGE_GROUP, y = crime, fill = SEX)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
geom_text(aes(label = crime), position = position_dodge(width = 0.9), vjust = -0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by SEX and AGE_GROUP",
x = "AGE_GROUP", y = "Count")
Freq(data$SEX)
Freq(data$AGE_GROUP)
Freq(data$AGE_COHORT)
Freq(data$CATEGORY)
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",linewidth = 2) +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.2, size = 4) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
ggplot(eda2, aes(x = CATEGORY, y = crime, fill = CATEGORY)) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = crime), vjust = -0.5, hjust = 0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by Category", x = "Category", y = "Count")
eda4 <- data %>%
group_by(SEX, ARREST_YEAR) %>%
summarize(crime = n(), .groups = "drop")
ggplot(eda3, aes(x = ARREST_YEAR, y = crime, fill = SEX)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
geom_text(aes(label = crime), position = position_dodge(width = 0.9), vjust = -0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by SEX and ARREST_YEAR",
x = "ARREST_YEAR", y = "Count")
ggplot(eda3, aes(x = ARREST_YEAR, y = crime, fill = SEX)) +
geom_line(color = "black") +
geom_text(aes(label = crime), position = position_dodge(width = 0.9), vjust = -0.5, size = 3, color = "black") +
scale_fill_brewer(palette = "Set1") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Crime Count by SEX and ARREST_YEAR",
x = "ARREST_YEAR", y = "Count")
citation("tidymodels")
#| caption: "Description of Columns in the Dataset"
#| label: tbl:dataset_description
kable(as.data.frame(frame(
Column = c("_id", "ARREST_YEAR", "DIVISION", "HOOD_158", "NEIGHBOURHOOD_158",
"SEX", "AGE_COHORT", "AGE_GROUP", "CATEGORY", "SUBTYPE", "ARREST_COUNT"),
Description = c("Unique row identifier for Open Data database",
"Year arrest was made",
"Geographic division where crime took place",
"Identifier of neighbourhood",
"Neighbourhood where crime took place",
"Sex of identified victim",
"Age cohort of identified victim",
"Age group of identified victim, adult or youth",
"Crime category",
"Crime category subtype",
"Count of arrested and charged person")
)))
#| caption: "Description of Columns in the Dataset"
#| label: tbl:dataset_description
kable(as.data.frame(frame(
Column = c("_id", "ARREST_YEAR", "DIVISION", "HOOD_158", "NEIGHBOURHOOD_158",
"SEX", "AGE_COHORT", "AGE_GROUP", "CATEGORY", "SUBTYPE", "ARREST_COUNT"),
Description = c("Unique row identifier for Open Data database",
"Year arrest was made",
"Geographic division where crime took place",
"Identifier of neighbourhood",
"Neighbourhood where crime took place",
"Sex of identified victim",
"Age cohort of identified victim",
"Age group of identified victim, adult or youth",
"Crime category",
"Crime category subtype",
"Count of arrested and charged person")
)))
#| caption: "Description of Columns in the Dataset"
#| label: tbl:dataset_description
kable(as.data.frame(matrix(
c("_id", "ARREST_YEAR", "DIVISION", "HOOD_158", "NEIGHBOURHOOD_158",
"SEX", "AGE_COHORT", "AGE_GROUP", "CATEGORY", "SUBTYPE", "ARREST_COUNT",
"Unique row identifier for Open Data database",
"Year arrest was made",
"Geographic division where crime took place",
"Identifier of neighbourhood",
"Neighbourhood where crime took place",
"Sex of identified victim",
"Age cohort of identified victim",
"Age group of identified victim, adult or youth",
"Crime category",
"Crime category subtype",
"Count of arrested and charged person"),
ncol = 2, byrow = TRUE),
dimnames = list(NULL, c("Column", "Description"))
))
citation("bruceR")
ggplot(eda1, aes(x = ARREST_YEAR, y = crime)) +
geom_line(color="blue",linewidth = 2) +
geom_text(aes(label = crime), vjust = 0.5, hjust = -0.2, size = 4) +
theme_bw() +
labs(title = "Crime Count Over Years", x = "Year", y = "Count")
install.packages("xfun")
install.packages("rmarkdown")
